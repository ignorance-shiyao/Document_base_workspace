# 需求规格说明书：政企业务智慧运维管家（SD-WAN 与智算场景扩展）

**文档状态：** 拟稿 **版本号：** V2.1 **文档类型：** 需求规格说明书 (SRS)

## 1. 引言

### 1.1 编写目的

本文档旨在明确政企业务智慧运维管家在 **SD-WAN**、**智算（AIDC）** 扩展及 **客户自助服务** 场景下的详细功能需求。重点定义系统在政企专线、5G 专网、IDC 等业务场景下的数据采集规范、逻辑处理规则及用户交互流程，为研发团队提供详细的开发依据。

### 1.2 适用范围

本文档适用于运维管家平台 V3.0 版本的迭代开发，核心覆盖以下模块：

- **SD-WAN 监控模块**：跨厂商网络监控与应用流量分析。
- **智算监控模块**：GPU 算力健康度与无损网络监控。
- **交付自动化模块**：业务自动开通、校验与回单。
- **客户自助服务模块**：面向最终客户的知识库、一键检测、智能问答与运维助手。

## 2. SD-WAN 业务可视化与质量监控

### 2.1 需求来源

为解决政企客户 SD-WAN 业务严重依赖厂商控制器、缺乏统一运维视图、Overlay 逻辑故障定界难的问题，需构建跨厂商的统一监控能力。

### 2.2 期望上线时间

2026年 9月

### 2.3 数据来源及接口规范

1. **基础配置数据**：通过网管能力网关调用控制器 Northbound API（RESTful），全量同步 Site、CPE Device、WAN Interface、Link 基础信息。
2. **性能指标数据**：采集 Tunnel 维度的 Latency（时延）, Jitter（抖动）, Packet Loss（丢包率）, Bandwidth Utilization（带宽利用率）。
   - *采集频度：5分钟粒度。*
3. **应用流量数据**：采集 Application Group (Video/ERP/Web等) 的 Traffic In/Out, Session Count。
4. **告警事件**：通过 Kafka 订阅控制器发出的 Trap/Syslog 转换后的标准告警事件。

### 2.4 功能需求详情

#### [F-SDWAN-01] SD-WAN 全网运行态势监控

- **功能描述**：提供租户视角的 SD-WAN 业务驾驶舱，聚合展示组网规模与健康状况。
- **处理逻辑**：
  1. **健康度评分模型**：
     - 输入：所有在线 Overlay 隧道的实时丢包率、时延。
     - 算法：`全网健康分 = 100 - Σ(单链路扣分权重)`。
     - 规则：单链路丢包 > 1% 扣 5 分，时延 > 200ms 扣 2 分；核心站点（Hub）离线直接扣 50 分。
  2. **状态聚合**：统计在线/离线站点数，计算 `在线率 = 在线站点 / 总站点`。
- **界面输出**：环形图（站点状态）、数字卡片（设备总数/异常数）、仪表盘（健康分）。

#### [F-SDWAN-02] 链路性能透视与智能选路分析

- **功能描述**：监控 Overlay 隧道的实时传输质量及选路策略执行情况。
- **处理逻辑**：
  1. **质差判定**：系统每 5 分钟轮询隧道指标，若 `丢包率 > 阈值(1%)` 或 `抖动 > 阈值(30ms)`，标记该隧道为“劣化状态”。
  2. **选路回溯**：监听控制器的 `Route_Switch` 事件。当流量路径发生变更（如 MPLS -> Internet）时，记录切换时间、切换原因（如 Primary Link Down）及受影响的应用组。
- **界面输出**：双轴折线图（左轴时延、右轴丢包）、选路切换日志列表。

#### [F-SDWAN-03] 应用级流量成分分析

- **功能描述**：识别并统计 Top N 应用的流量消耗。
- **处理逻辑**：
  1. **数据归并**：将原始 DPI 数据按 `应用组`（如：关键业务、办公、娱乐）进行聚合。
  2. **排行统计**：计算指定时间窗口内（1小时/24小时）总流量最大的前 5 个应用。
- **界面输出**：Top 5 应用流量排行（横向柱状图）、流量成分占比（饼图）。

## 3. 智算（AIDC）全栈监控与故障定界

### 3.1 需求来源

针对智算中心“算力昂贵、训练敏感”的特性，打破“服务器黑盒”，将监控颗粒度下沉至 GPU 模组与 RoCE 网络端口。

### 3.2 期望上线时间

2026年 10月

### 3.3 数据来源及接口规范

1. **GPU 指标**：对接 Prometheus/Grafana，采集 `DCGM Exporter` 输出的 GPU Util, Temp, Power, ECC Errors, XID Errors。
2. **网络指标**：通过 SNMP/Telemetry 采集交换机端口的 `PFC Frames`, `ECN Marked Packets`, `CRC Errors`。

### 3.4 功能需求详情

#### [F-AIDC-01] GPU 深度健康监测与故障排行

- **功能描述**：识别硬件层面的亚健康风险，提供故障排查线索。
- **处理逻辑**：
  1. **亚健康预警**：
     - 规则 A：单卡 `SRAM/DRAM ECC Error` 增量 > 0，标记为“硬件隐患”。
     - 规则 B：单卡温度持续 10 分钟 > 85℃，标记为“过热风险”。
  2. **故障排行**：按 `错误计数` 倒序排列所有 GPU 节点。
- **界面输出**：集群温度热力图、故障节点滚动列表。

#### [F-AIDC-02] RoCE 无损网络拥塞分析

- **功能描述**：监控高性能网络的拥塞状况，定位训练卡顿根因。
- **处理逻辑**：
  1. **死锁检测**：监测交换机端口的 `PFC Sent/Received` 速率。若速率 > 1000 pps 且持续 1 分钟，判定为 `PFC Storm`（死锁风险），触发告警。
  2. **丢包关联**：若检测到 `CRC Errors > 0`，自动关联该端口连接的光模块与线缆信息，提示物理层排查。
- **界面输出**：PFC/ECN 计数趋势图、拥塞端口 Top 列表。

## 4. 交付自动化：自助开通与回单

### 4.1 需求来源

提升政企业务开通效率，实现开通工单的自动接收、校验、账号创建与回单。

### 4.2 期望上线时间

2026年 9月

### 4.3 功能需求详情

#### [F-DELIVERY-01] 开通工单自动处理引擎

- **功能描述**：后台自动处理接收到的开通工单。
- **处理流程**：
  1. **接收**：从前台系统接收 JSON 工单（含客户编码、产标、带宽等）。
  2. **校验**：
     - 步骤 1：查询 CRM 视图，验证客户编码是否存在且状态正常。
     - 步骤 2：查询资源存量库，验证产品实例标识（产标）是否已归档。
  3. **执行**：
     - 若校验通过：调用 IAM 接口创建账号 -> 生成随机密码 -> 调用前台接口回单（状态 Success）。
     - 若校验失败：标记工单状态 `WAIT_REVIEW` -> 调用短信网关通知运维接口人。

#### [F-DELIVERY-02] 异常工单人工复核

- **功能描述**：提供界面供运维人员处理自动校验失败的工单。
- **界面要素**：原始工单信息（只读）、失败原因（如：产标不存在）、修正表单（可编辑客户名称/产标）。
- **操作逻辑**：
  - **修正并重试**：提交新数据，重新触发 [F-DELIVERY-01] 流程。
  - **确认失败**：输入“退单原因”，系统调用前台接口回单（状态 Fail）。

## 5. 客户自助服务与运维支撑

### 5.1 需求来源

为提升客户侧运维体验，降低报障和答疑门槛，需建设统一的客户自助服务门户，涵盖知识库、一键检测、一键交付、智能简报、运维助手及智能问答六大能力。

### 5.2 期望上线时间

2026年 11月

### 5.3 数据来源及接口规范

1. **诊断执行接口**：
   - **专线**：调用 PON 网管接口查询光衰，调用 AAA 接口查询在线状态。
   - **5G**：调用 CMP 平台查询 SIM 卡状态，调用 CPE 管理平台查询 RSRP。
   - **IDC**：调用动环系统查询温湿度、电流。
2. **知识库数据**：CMS 系统图文数据。
3. **大模型接口**：私有化部署 LLM API（ChatCompletion）。

### 5.4 功能需求详情

#### [F-SERVICE-01] 客户知识库与自助查询

- **功能描述**：面向客户的帮助中心，支持分业务检索与反馈。
- **功能逻辑**：
  1. **知识分类映射**：
     - 若客户订购“互联网专线”，默认展示《光猫状态灯说明》、《路由器 WAN 口配置》。
     - 若客户订购“5G 专网”，默认展示《CPE 摆放指南》、《切片业务卡顿排查》。
  2. **智能检索**：支持对 `Tag`（如：红灯闪烁、网速慢、丢包）的模糊匹配，权重高于全文匹配。
  3. **闭环反馈**：记录用户点击“有用/无用”的操作。当“无用”比例 > 30% 时，生成内容优化任务推送到运营后台。
- **界面输出**：搜索栏、热门问题 Top10、图文详情页（含视频嵌入）。

#### [F-SERVICE-02] 客户侧一键检测与报障

- **功能描述**：集成多源诊断能力，生成体检报告并支持转报障。
- **处理逻辑**：
  1. **场景识别**：系统根据当前登录用户的产品实例类型，自动加载诊断脚本。
  2. **并发诊断执行**：
     - **互联网/专线场景**：
       - *Check 1*: 查询光猫收光功率。**阈值**：Rx < -27dBm 判定异常。
       - *Check 2*: Ping 公网网关。**阈值**：丢包 > 5% 或 时延 > 50ms 判定异常。
       - *Check 3*: 查询带宽利用率。**阈值**：近 15 分钟峰值 > 95% 判定拥塞。
     - **5G 专网场景**：
       - *Check 1*: 查询 SIM 卡 HSS 状态。**期望**：Active。
       - *Check 2*: 查询 RSRP（信号强度）。**阈值**：< -105dBm 判定弱覆盖。
     - **IDC 场景**：
       - *Check 1*: 查询机柜进风温度。**阈值**：> 28℃ 判定高温。
  3. **报告生成与转报障**：
     - 生成《网络体检简报》，标红异常项。
     - 提供“一键报障”按钮。点击后自动创建工单，将“光功率：-32dBm”等诊断数据自动填入工单详情，无需客户手写。

#### [F-SERVICE-03] 一键交付与多业务支持

- **功能描述**：客户侧发起的新业务开通或变更需求，支持模板化的一键提交。
- **处理逻辑**：
  1. **模板匹配**：
     - **5G 切片开通**：加载模板，必填项简化为“SIM 卡号段”、“切片带宽等级”。系统自动关联 DNN 默认参数。
     - **SD-WAN 站点扩容**：加载模板，必填项简化为“发货地址”、“联系人”、“带宽大小”。
  2. **流程触发**：提交后，自动生成“开通工单”，流转至后台 [F-DELIVERY-01] 引擎进行处理。
  3. **进度可视**：在门户以时间轴形式展示“提交 -> 审批 -> 发货 -> 配置下发 -> 完工”全流程。

#### [F-SERVICE-04] 智能简报与自动报告

- **功能描述**：周期性生成业务运行报告并推送。
- **处理逻辑**：
  1. **数据聚合（ETL）**：每日凌晨 2:00 触发任务，聚合前一日的流量、告警、工单数据。
  2. **报告渲染**：
     - **专线月报**：SLA 达标率日历图（每日颜色标识）、流量峰值趋势图、故障中断明细表。
     - **IDC 月报**：能耗（kWh）趋势图、温湿度曲线、门禁通行 Top 人员。
  3. **推送调度**：根据客户订阅配置（频率：日/周/月，渠道：邮件/企微），调用消息网关发送 PDF 附件或 H5 链接。

#### [F-SERVICE-05] 客户运维助手与消息通知

- **功能描述**：门户侧边栏/悬浮窗，作为消息中心与快捷入口。
- **处理逻辑**：
  1. **动态看板**：轮询接口，实时展示“当前未恢复告警数”、“本月工单数”、“即将到期的服务”。
  2. **消息分级订阅与推送**：
     - **Level 1 (紧急)**：如“专线中断”、“市电停电”。动作：APP 弹窗 + 短信强提醒。
     - **Level 2 (重要)**：如“割接预告”、“SLA 越限风险”。动作：微信推送。
     - **Level 3 (一般)**：如“月报生成”、“营销活动”。动作：站内信红点。
  3. **助手快捷键**：提供“我要报障”、“人工客服”、“测速”快捷入口。

#### [F-SERVICE-06] 智能问答与互动服务

- **功能描述**：基于 LLM 的自然语言交互窗口。
- **交互逻辑**：
  1. **意图识别**：用户输入“网速慢”，模型识别意图为 `INTENT_DIAGNOSE_SPEED`。
  2. **实体抽取与反问**：若用户未指定线路，模型反问：“请问是查询 [线路A] 还是 [线路B] ？”
  3. **API 编排**：获取明确意图后，后端调用 [F-SERVICE-02] 的诊断接口获取实时数据。
  4. **答案生成**：将 API 返回的 JSON 数据（如 `utilization: 99%`）转化为自然语言：“检测到您的线路 A 当前带宽利用率达到 99%，可能是内网流量拥塞导致。”
  5. **推荐行动**：在回复后附带 Action Chips（操作胶囊），如“查看流量排名前5的应用”、“联系客户经理扩容”。